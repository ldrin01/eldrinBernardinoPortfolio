import{h as S,H as N,I as w,P as C,q as l,j as B,r as E,J as x,L as F,i as A,K as q,n as M,M as k,N as T,O,Q as P,R as U,S as V,T as W,U as z,V as J,W as Q,X}from"./DiTxtPKb.js";const L=(o="RouteProvider")=>S({name:o,props:{route:{type:Object,required:!0},vnode:Object,vnodeRef:Object,renderKey:String,trackRootNodes:Boolean},setup(t){const n=t.renderKey,u=t.route,a={};for(const r in t.route)Object.defineProperty(a,r,{get:()=>n===t.renderKey?t.route[r]:u[r],enumerable:!0});return N(C,w(a)),()=>t.vnode?l(t.vnode,{ref:t.vnodeRef}):t.vnode}}),D=L(),j=new WeakMap,ne=S({name:"NuxtPage",inheritAttrs:!1,props:{name:{type:String},transition:{type:[Boolean,Object],default:void 0},keepalive:{type:[Boolean,Object],default:void 0},route:{type:Object},pageKey:{type:[Function,String],default:null}},setup(o,{attrs:t,slots:n,expose:u}){const a=B(),r=E(),i=x(C,null);let c;u({pageRef:r});const s=x(F,null);let d;const m=a.deferHydration();if(a.isHydrating){const e=a.hooks.hookOnce("app:error",m);A().beforeEach(e)}o.pageKey&&q(()=>o.pageKey,(e,h)=>{e!==h&&a.callHook("page:loading:start")});let f=!1;{const e=A().beforeResolve(()=>{f=!1});M(()=>{e()})}return()=>l(z,{name:o.name,route:o.route,...t},{default:e=>{const h=Y(i,e.route,e.Component),p=i&&i.matched.length===e.route.matched.length;if(!e.Component){if(d&&!p)return d;m();return}if(d&&s&&!s.isCurrent(e.route))return d;if(h&&i&&(!s||s!=null&&s.isCurrent(i)))return p?d:null;const g=k(e,o.pageKey),K=Z(i,e.route,e.Component);!a.isHydrating&&c===g&&!K&&T(()=>{f=!0,a.callHook("page:loading:end")}),c=g;const v=!!(o.transition??e.route.meta.pageTransition??O),I=v&&G([o.transition,e.route.meta.pageTransition,O,{onAfterLeave(){delete a._runningTransition,a.callHook("page:transition:finish",e.Component)}}]),b=o.keepalive??e.route.meta.keepalive??P;return d=U(v&&I,V(b,l(W,{suspensible:!0,onPending:()=>{v&&(a._runningTransition=!0),a.callHook("page:start",e.Component)},onResolve:()=>{T(()=>a.callHook("page:finish",e.Component).then(()=>{if(!f&&!K)return f=!0,a.callHook("page:loading:end")}).finally(m))}},{default:()=>{const H={key:g||void 0,vnode:n.default?$(n.default,e):e.Component,route:e.route,renderKey:g||void 0,trackRootNodes:v,vnodeRef:r};if(!b)return l(D,H);const R=e.Component.type,_=R;let y=j.get(_);return y||(y=L(R.name||R.__name),j.set(_,y)),l(y,H)}}))).default(),d}})}});function G(o){const t=o.filter(Boolean).map(n=>({...n,onAfterLeave:n.onAfterLeave?J(n.onAfterLeave):void 0}));return Q(...t)}function Y(o,t,n){if(!o)return!1;const u=t.matched.findIndex(a=>{var r;return((r=a.components)==null?void 0:r.default)===(n==null?void 0:n.type)});return!u||u===-1?!1:t.matched.slice(0,u).some((a,r)=>{var i,c,s;return((i=a.components)==null?void 0:i.default)!==((s=(c=o.matched[r])==null?void 0:c.components)==null?void 0:s.default)})||n&&k({route:t,Component:n})!==k({route:o,Component:n})}function Z(o,t,n){return o?t.matched.findIndex(a=>{var r;return((r=a.components)==null?void 0:r.default)===(n==null?void 0:n.type)})<t.matched.length-1:!1}function $(o,t){const n=o(t);return n.length===1?l(n[0]):l(X,void 0,n)}export{ne as _};

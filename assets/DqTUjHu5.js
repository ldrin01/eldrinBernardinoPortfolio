import{h as S,M as w,N as B,P as C,k as l,i as I,q as E,p as A,j as F,z as q,R as z,O as H,Q as M,S as k,T,U as O,V as P,W as U,X as V,Y as W,Z as Q,$ as X,a0 as Y}from"./Dovl8Xmp.js";const L=(o="RouteProvider")=>S({name:o,props:{route:{type:Object,required:!0},vnode:Object,vnodeRef:Object,renderKey:String,trackRootNodes:Boolean},setup(t){const n=t.renderKey,u=t.route,a={};for(const r in t.route)Object.defineProperty(a,r,{get:()=>n===t.renderKey?t.route[r]:u[r],enumerable:!0});return w(C,B(a)),()=>t.vnode?l(t.vnode,{ref:t.vnodeRef}):t.vnode}}),Z=L(),j=new WeakMap,ne=S({name:"NuxtPage",inheritAttrs:!1,props:{name:{type:String},transition:{type:[Boolean,Object],default:void 0},keepalive:{type:[Boolean,Object],default:void 0},route:{type:Object},pageKey:{type:[Function,String],default:null}},setup(o,{attrs:t,slots:n,expose:u}){const a=I(),r=E(),i=H(C,null);let c;u({pageRef:r});const s=H(M,null);let d;const m=a.deferHydration();if(a.isHydrating){const e=a.hooks.hookOnce("app:error",m);A().beforeEach(e)}o.pageKey&&F(()=>o.pageKey,(e,h)=>{e!==h&&a.callHook("page:loading:start")});let f=!1;{const e=A().beforeResolve(()=>{f=!1});q(()=>{e()})}return()=>l(z,{name:o.name,route:o.route,...t},{default:e=>{const h=D(i,e.route,e.Component),p=i&&i.matched.length===e.route.matched.length;if(!e.Component){if(d&&!p)return d;m();return}if(d&&s&&!s.isCurrent(e.route))return d;if(h&&i&&(!s||s!=null&&s.isCurrent(i)))return p?d:null;const g=k(e,o.pageKey),b=G(i,e.route,e.Component);!a.isHydrating&&c===g&&!b&&T(()=>{f=!0,a.callHook("page:loading:end")}),c=g;const v=!!(o.transition??e.route.meta.pageTransition??O),N=v&&$([o.transition,e.route.meta.pageTransition,O,{onAfterLeave(){delete a._runningTransition,a.callHook("page:transition:finish",e.Component)}}]),K=o.keepalive??e.route.meta.keepalive??P;return d=U(v&&N,V(K,l(W,{suspensible:!0,onPending:()=>{v&&(a._runningTransition=!0),a.callHook("page:start",e.Component)},onResolve:()=>{T(()=>a.callHook("page:finish",e.Component).then(()=>{if(!f&&!b)return f=!0,a.callHook("page:loading:end")}).finally(m))}},{default:()=>{const _={key:g||void 0,vnode:n.default?J(n.default,e):e.Component,route:e.route,renderKey:g||void 0,trackRootNodes:v,vnodeRef:r};if(!K)return l(Z,_);const R=e.Component.type,x=R;let y=j.get(x);return y||(y=L(R.name||R.__name),j.set(x,y)),l(y,_)}}))).default(),d}})}});function $(o){const t=o.filter(Boolean).map(n=>({...n,onAfterLeave:n.onAfterLeave?Q(n.onAfterLeave):void 0}));return X(...t)}function D(o,t,n){if(!o)return!1;const u=t.matched.findIndex(a=>{var r;return((r=a.components)==null?void 0:r.default)===(n==null?void 0:n.type)});return!u||u===-1?!1:t.matched.slice(0,u).some((a,r)=>{var i,c,s;return((i=a.components)==null?void 0:i.default)!==((s=(c=o.matched[r])==null?void 0:c.components)==null?void 0:s.default)})||n&&k({route:t,Component:n})!==k({route:o,Component:n})}function G(o,t,n){return o?t.matched.findIndex(a=>{var r;return((r=a.components)==null?void 0:r.default)===(n==null?void 0:n.type)})<t.matched.length-1:!1}function J(o,t){const n=o(t);return n.length===1?l(n[0]):l(Y,void 0,n)}export{ne as _};

import{N as S,z as w,ad as B,ae as C,P as l,O as I,q as F,W as A,F as E,a0 as q,af as z,k as H,ag as P,ah as R,ai as O,aj as T,ak as W,al as J,am as M,an as U,ao as V,J as D,S as G}from"./CIwfKAm_.js";const L=(o="RouteProvider")=>S({name:o,props:{route:{type:Object,required:!0},vnode:Object,vnodeRef:Object,renderKey:String,trackRootNodes:Boolean},setup(t){const n=t.renderKey,u=t.route,a={};for(const r in t.route)Object.defineProperty(a,r,{get:()=>n===t.renderKey?t.route[r]:u[r],enumerable:!0});return w(C,B(a)),()=>t.vnode?l(t.vnode,{ref:t.vnodeRef}):t.vnode}}),Q=L(),j=new WeakMap,ne=S({name:"NuxtPage",inheritAttrs:!1,props:{name:{type:String},transition:{type:[Boolean,Object],default:void 0},keepalive:{type:[Boolean,Object],default:void 0},route:{type:Object},pageKey:{type:[Function,String],default:null}},setup(o,{attrs:t,slots:n,expose:u}){const a=I(),r=F(),i=H(C,null);let c;u({pageRef:r});const s=H(P,null);let d;const y=a.deferHydration();if(a.isHydrating){const e=a.hooks.hookOnce("app:error",y);A().beforeEach(e)}o.pageKey&&E(()=>o.pageKey,(e,h)=>{e!==h&&a.callHook("page:loading:start")});let f=!1;{const e=A().beforeResolve(()=>{f=!1});q(()=>{e()})}return()=>l(z,{name:o.name,route:o.route,...t},{default:e=>{const h=Y(i,e.route,e.Component),p=i&&i.matched.length===e.route.matched.length;if(!e.Component){if(d&&!p)return d;y();return}if(d&&s&&!s.isCurrent(e.route))return d;if(h&&i&&(!s||s!=null&&s.isCurrent(i)))return p?d:null;const g=R(e,o.pageKey),b=Z(i,e.route,e.Component);!a.isHydrating&&c===g&&!b&&O(()=>{f=!0,a.callHook("page:loading:end")}),c=g;const v=!!(o.transition??e.route.meta.pageTransition??T),N=v&&X([o.transition,e.route.meta.pageTransition,T,{onAfterLeave(){delete a._runningTransition,a.callHook("page:transition:finish",e.Component)}}]),K=o.keepalive??e.route.meta.keepalive??W;return d=J(v&&N,M(K,l(U,{suspensible:!0,onPending:()=>{v&&(a._runningTransition=!0),a.callHook("page:start",e.Component)},onResolve:()=>{O(()=>a.callHook("page:finish",e.Component).then(()=>{if(!f&&!b)return f=!0,a.callHook("page:loading:end")}).finally(y))}},{default:()=>{const _={key:g||void 0,vnode:n.default?$(n.default,e):e.Component,route:e.route,renderKey:g||void 0,trackRootNodes:v,vnodeRef:r};if(!K)return l(Q,_);const k=e.Component.type,x=k;let m=j.get(x);return m||(m=L(k.name||k.__name),j.set(x,m)),l(m,_)}}))).default(),d}})}});function X(o){const t=o.filter(Boolean).map(n=>({...n,onAfterLeave:n.onAfterLeave?V(n.onAfterLeave):void 0}));return D(...t)}function Y(o,t,n){if(!o)return!1;const u=t.matched.findIndex(a=>{var r;return((r=a.components)==null?void 0:r.default)===(n==null?void 0:n.type)});return!u||u===-1?!1:t.matched.slice(0,u).some((a,r)=>{var i,c,s;return((i=a.components)==null?void 0:i.default)!==((s=(c=o.matched[r])==null?void 0:c.components)==null?void 0:s.default)})||n&&R({route:t,Component:n})!==R({route:o,Component:n})}function Z(o,t,n){return o?t.matched.findIndex(a=>{var r;return((r=a.components)==null?void 0:r.default)===(n==null?void 0:n.type)})<t.matched.length-1:!1}function $(o,t){const n=o(t);return n.length===1?l(n[0]):l(G,void 0,n)}export{ne as _};

import{k as j,J as w,K as B,P as C,x as l,m as I,f as E,L as A,M as F,l as H,N as q,q as M,O as k,Q as T,R as O,S as P,T as U,U as V,V as W,W as z,X as J,Y as Q,Z as X}from"./BQW3_0I1.js";const L=(o="RouteProvider")=>j({name:o,props:{route:{type:Object,required:!0},vnode:Object,vnodeRef:Object,renderKey:String,trackRootNodes:Boolean},setup(t){const n=t.renderKey,u=t.route,a={};for(const r in t.route)Object.defineProperty(a,r,{get:()=>n===t.renderKey?t.route[r]:u[r],enumerable:!0});return w(C,B(a)),()=>t.vnode?l(t.vnode,{ref:t.vnodeRef}):t.vnode}}),Y=L(),S=new WeakMap,ne=j({name:"NuxtPage",inheritAttrs:!1,props:{name:{type:String},transition:{type:[Boolean,Object],default:void 0},keepalive:{type:[Boolean,Object],default:void 0},route:{type:Object},pageKey:{type:[Function,String],default:null}},setup(o,{attrs:t,slots:n,expose:u}){const a=I(),r=E(),i=A(C,null);let c;u({pageRef:r});const s=A(F,null);let d;const y=a.deferHydration();if(a.isHydrating){const e=a.hooks.hookOnce("app:error",y);H().beforeEach(e)}o.pageKey&&q(()=>o.pageKey,(e,h)=>{e!==h&&a.callHook("page:loading:start")});let f=!1;{const e=H().beforeResolve(()=>{f=!1});M(()=>{e()})}return()=>l(z,{name:o.name,route:o.route,...t},{default:e=>{const h=D(i,e.route,e.Component),p=i&&i.matched.length===e.route.matched.length;if(!e.Component){if(d&&!p)return d;y();return}if(d&&s&&!s.isCurrent(e.route))return d;if(h&&i&&(!s||s!=null&&s.isCurrent(i)))return p?d:null;const g=k(e,o.pageKey),K=G(i,e.route,e.Component);!a.isHydrating&&c===g&&!K&&T(()=>{f=!0,a.callHook("page:loading:end")}),c=g;const v=!!(o.transition??e.route.meta.pageTransition??O),N=v&&Z([o.transition,e.route.meta.pageTransition,O,{onAfterLeave(){delete a._runningTransition,a.callHook("page:transition:finish",e.Component)}}]),b=o.keepalive??e.route.meta.keepalive??P;return d=U(v&&N,V(b,l(W,{suspensible:!0,onPending:()=>{v&&(a._runningTransition=!0),a.callHook("page:start",e.Component)},onResolve:()=>{T(()=>a.callHook("page:finish",e.Component).then(()=>{if(!f&&!K)return f=!0,a.callHook("page:loading:end")}).finally(y))}},{default:()=>{const x={key:g||void 0,vnode:n.default?$(n.default,e):e.Component,route:e.route,renderKey:g||void 0,trackRootNodes:v,vnodeRef:r};if(!b)return l(Y,x);const R=e.Component.type,_=R;let m=S.get(_);return m||(m=L(R.name||R.__name),S.set(_,m)),l(m,x)}}))).default(),d}})}});function Z(o){const t=o.filter(Boolean).map(n=>({...n,onAfterLeave:n.onAfterLeave?J(n.onAfterLeave):void 0}));return Q(...t)}function D(o,t,n){if(!o)return!1;const u=t.matched.findIndex(a=>{var r;return((r=a.components)==null?void 0:r.default)===(n==null?void 0:n.type)});return!u||u===-1?!1:t.matched.slice(0,u).some((a,r)=>{var i,c,s;return((i=a.components)==null?void 0:i.default)!==((s=(c=o.matched[r])==null?void 0:c.components)==null?void 0:s.default)})||n&&k({route:t,Component:n})!==k({route:o,Component:n})}function G(o,t,n){return o?t.matched.findIndex(a=>{var r;return((r=a.components)==null?void 0:r.default)===(n==null?void 0:n.type)})<t.matched.length-1:!1}function $(o,t){const n=o(t);return n.length===1?l(n[0]):l(X,void 0,n)}export{ne as _};
